# 会员搜索功能增强文档

## 问题描述

原系统中，会员搜索功能仅支持通过会员姓名进行搜索，不支持通过邮箱搜索，这限制了用户在不记得会员姓名但知道邮箱时的搜索能力。

此外，会员列表中的状态显示与搜索筛选中的到期状态选项不一致，缺少"课时不足"选项。

## 解决方案

对系统进行以下修改：

1. 修改签到记录页面（CheckInRecordsList）的搜索框标签和提示文本
2. 修改会员管理页面（MemberList）的搜索框标签和提示文本
3. 更新后端搜索逻辑，使其同时支持姓名和邮箱搜索
4. 在会员管理页面的到期状态筛选中添加"课时不足"选项，使其与会员列表中的状态显示一致

## 执行的更改

### 前端更改

1. 修改签到记录页面（CheckInRecordsList.tsx）：
   - 将搜索框标签从"会员姓名 Member Name"改为"会员姓名/邮箱 Member Name/Email"
   - 将搜索框提示文本从"输入会员姓名..."改为"输入会员姓名或邮箱..."

2. 修改会员管理页面（MemberList.tsx）：
   - 将搜索框标签从"姓名/微信名 Name/WeChat"改为"姓名/微信名/邮箱 Name/WeChat/Email"
   - 将搜索框提示文本从"搜索会员..."改为"搜索会员姓名或邮箱..."
   - 在到期状态筛选下拉菜单中添加"课时不足 Low Classes"选项

### 后端更改

1. 修改签到记录搜索逻辑（useCheckInRecordsPaginated.ts）：
   - 更新查询条件，使其同时支持通过会员姓名和邮箱进行搜索
   - 使用Supabase的or查询功能，同时匹配name和email字段

2. 更新会员搜索逻辑（useMemberSearch.ts）：
   - 添加对"课时不足"状态的支持
   - 定义"课时不足"为团课次卡剩余课时小于等于2次

## 状态定义统一

为确保系统中状态定义的一致性，现在所有状态定义如下：

1. **正常 Active**：会员卡未过期且不在即将到期范围内
2. **即将到期 Expiring Soon**：会员卡将在7天内到期
3. **已过期 Expired**：会员卡已经过期
4. **课时不足 Low Classes**：团课次卡剩余课时小于等于2次

## 结果

1. 用户现在可以在签到记录页面通过会员姓名或邮箱搜索签到记录
2. 用户现在可以在会员管理页面通过会员姓名、微信名或邮箱搜索会员
3. 搜索功能更加灵活，提高了用户体验
4. 会员管理页面的到期状态筛选选项与会员列表中的状态显示一致，使用户体验更加一致

## 注意事项

1. 搜索是模糊匹配的，会返回姓名或邮箱中包含搜索词的所有结果
2. 搜索不区分大小写
3. 如果搜索结果过多，建议用户提供更精确的搜索词
4. "课时不足"状态仅适用于团课次卡，不适用于月卡和私教卡 